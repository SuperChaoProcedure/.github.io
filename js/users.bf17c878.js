(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["users"],{"09b7":function(e,t,r){},"1dde":function(e,t,r){var s=r("d039"),a=r("b622"),n=r("2d00"),i=a("species");e.exports=function(e){return n>=51||!s((function(){var t=[],r=t.constructor={};return r[i]=function(){return{foo:1}},1!==t[e](Boolean).foo}))}},2660:function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-breadcrumb",{attrs:{separator:">"}},[r("el-breadcrumb-item",{attrs:{to:{path:"/welcome"}}},[e._v("首页")]),r("el-breadcrumb-item",[e._v("用户管理")]),r("el-breadcrumb-item",[e._v("用户列表")])],1),r("el-card",[r("el-row",[r("el-col",{attrs:{span:8}},[r("el-input",{attrs:{placeholder:"请输入内容"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.serchUsers(t)}},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}},[r("template",{slot:"append"},[r("el-button",{staticClass:"el-icon-search",on:{click:e.serchUsers}})],1)],2)],1),r("el-col",{attrs:{span:16}},[r("div",[r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.addDialogVisible=!0}}},[e._v("添加用户")])],1)])],1),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.UsersList,stripe:"",border:""}},[r("el-table-column",{attrs:{label:"#",type:"index",width:"100"}}),r("el-table-column",{attrs:{prop:"username",label:"姓名",width:"180"}}),r("el-table-column",{attrs:{prop:"email",label:"邮箱",width:"180"}}),r("el-table-column",{attrs:{prop:"mobile",label:"电话",width:"180"}}),r("el-table-column",{attrs:{prop:"role_name",label:"角色",width:"180"}}),r("el-table-column",{attrs:{label:"状态",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"gray"},on:{change:function(r){return e.changeState(t.row.id,t.row.mg_state)}},model:{value:t.row.mg_state,callback:function(r){e.$set(t.row,"mg_state",r)},expression:"scope.row.mg_state"}})]}}])}),r("el-table-column",{attrs:{label:"操作",width:"220"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini"},on:{click:function(r){return e.editMessage(t.row)}}}),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete",size:"mini"},on:{click:function(r){return e.delUsers(t.row)}}}),r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"分配角色",placement:"top"}},[r("el-button",{attrs:{type:"warning",icon:"el-icon-setting",size:"mini"},on:{click:function(r){return e.UsersCate(t.row)}}})],1)]}}])})],1),r("el-pagination",{attrs:{"current-page":e.queryInfo.pagenum,"page-sizes":[1,2,3,4],"page-size":e.queryInfo.pagesize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1),r("el-dialog",{attrs:{title:"提示",visible:e.addDialogVisible,width:"50%"},on:{"update:visible":function(t){e.addDialogVisible=t}}},[r("el-form",{ref:"addFormRef",attrs:{model:e.addForm,"label-width":"80px",rules:e.addFormRules}},[r("el-form-item",{attrs:{label:"用户名",prop:"username"}},[r("el-input",{model:{value:e.addForm.username,callback:function(t){e.$set(e.addForm,"username",t)},expression:"addForm.username"}})],1),r("el-form-item",{attrs:{label:"密码",prop:"password"}},[r("el-input",{attrs:{type:"password"},model:{value:e.addForm.password,callback:function(t){e.$set(e.addForm,"password",t)},expression:"addForm.password"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{model:{value:e.addForm.email,callback:function(t){e.$set(e.addForm,"email",t)},expression:"addForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.addUsers(t)}},model:{value:e.addForm.mobile,callback:function(t){e.$set(e.addForm,"mobile",t)},expression:"addForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.addDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.addUsers}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"提示",visible:e.editDialogVisible,width:"50%"},on:{"update:visible":function(t){e.editDialogVisible=t}}},[r("el-form",{ref:"editFormRef",attrs:{model:e.editForm,"label-width":"80px",rules:e.addFormRules}},[r("el-form-item",{attrs:{label:"用户名"}},[r("el-input",{attrs:{disabled:""},model:{value:e.editForm.username,callback:function(t){e.$set(e.editForm,"username",t)},expression:"editForm.username"}})],1),r("el-form-item",{attrs:{label:"邮箱",prop:"email"}},[r("el-input",{nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.nextFocus(t)}},model:{value:e.editForm.email,callback:function(t){e.$set(e.editForm,"email",t)},expression:"editForm.email"}})],1),r("el-form-item",{attrs:{label:"手机",prop:"mobile"}},[r("el-input",{ref:"mobileInputRef",nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.editUsers(t)}},model:{value:e.editForm.mobile,callback:function(t){e.$set(e.editForm,"mobile",t)},expression:"editForm.mobile"}})],1)],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.editUsers}},[e._v("确 定")])],1)],1),r("el-dialog",{attrs:{title:"提示",visible:e.UsersDialogVisible,width:"30%"},on:{"update:visible":function(t){e.UsersDialogVisible=t}}},[r("el-form",{ref:"form",attrs:{model:e.UsersForm,"label-width":"80px"}},[r("el-form-item",[r("p",[e._v("用户名: "+e._s(e.UsersForm.username))]),r("p",[e._v("当前角色: "+e._s(e.UsersForm.role_name))]),r("div",[r("span",[e._v("选择当前角色:")]),r("el-select",{attrs:{placeholder:"请选择活动区域"},model:{value:e.selectRolesId,callback:function(t){e.selectRolesId=t},expression:"selectRolesId"}},e._l(e.UsersForm.Users,(function(e,t){return r("el-option",{key:t,attrs:{label:e.roleName,value:e.id}})})),1)],1)])],1),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.UsersDialogVisible=!1}}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.RolesAllocation}},[e._v("确 定")])],1)],1)],1)},a=[],n=(r("99af"),r("4160"),r("159b"),r("96cf"),r("1da1")),i={created:function(){this.getUsersList()},data:function(){var e=function(e,t,r){var s=/^(0|86|17951)?(13[0-9]|15[012356789]|166|17[3678]|18[0-9]|14[57])[0-9]{8}$/;s.test(t)?r():r(new Error("手机格式错误"))},t=function(e,t,r){var s=/\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*/;s.test(t)?r():r(new Error("邮箱格式错误"))};return{queryInfo:{query:"",pagenum:1,pagesize:2},UsersList:[],total:null,addForm:{username:"",password:"",email:"",mobile:""},addDialogVisible:!1,addFormRules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:10,message:"长度在 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:15,message:"长度在 6 到 15 个字符",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:t,trigger:"blur"}],mobile:[{required:!0,message:"请输入手机号",trigger:"blur"},{validator:e,trigger:"blur"}]},content:"",editDialogVisible:!1,editForm:{username:"",email:"",mobile:""},editId:"",UsersDialogVisible:!1,UsersForm:{username:"",role_name:"",Users:[]},selectRolesId:""}},methods:{getUsersList:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.get("/users",{params:e.queryInfo});case 2:if(r=t.sent,200===r.meta.status){t.next=5;break}return t.abrupt("return",e.$message.error(r.meta.msg));case 5:e.UsersList=r.data.users,e.total=r.data.total;case 7:case"end":return t.stop()}}),t)})))()},changeState:function(e,t){var r=this;return Object(n["a"])(regeneratorRuntime.mark((function s(){var a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,r.$http.put("users/".concat(e,"/state/").concat(t));case 2:if(a=s.sent,200===a.meta.status){s.next=5;break}return s.abrupt("return",r.$message.error(a.meta.msg));case 5:r.$message.success(a.meta.msg);case 6:case"end":return s.stop()}}),s)})))()},addUsers:function(){var e=this;this.$refs.addFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("校验失败"));case 2:return t.next=4,e.$http.post("/users",e.addForm);case 4:if(s=t.sent,201===s.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error(s.meta.msg));case 7:e.$message.success(s.meta.msg),e.getUsersList(),e.addDialogVisible=!1;case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleSizeChange:function(e){this.queryInfo.pagesize=e,this.getUsersList()},handleCurrentChange:function(e){this.queryInfo.pagenum=e,this.getUsersList()},serchUsers:function(){this.queryInfo.query=this.content,this.getUsersList(),this.content=""},editMessage:function(e){this.editId=e.id,this.editForm.username=e.username,this.editForm.email=e.email,this.editForm.mobile=e.mobile,this.editDialogVisible=!0},editUsers:function(){var e=this;this.$refs.editFormRef.validate(function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(r){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r){t.next=2;break}return t.abrupt("return",e.$message.error("校验失败！"));case 2:return t.next=4,e.$http.put("users/".concat(e.editId),e.editForm);case 4:if(s=t.sent,200===s.meta.status){t.next=7;break}return t.abrupt("return",e.$message.error(s.meta.msg));case 7:e.$message.success(s.meta.msg),e.role_id=s.data.role_id,e.getUsersList(),e.editDialogVisible=!1;case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},nextFocus:function(){this.$refs.mobileInputRef.focus()},delUsers:function(e){var t=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(n["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.delete("users/".concat(e.id));case 2:if(s=r.sent,200===s.meta.status){r.next=5;break}return r.abrupt("return",t.$message.error(s.meta.msg));case 5:t.$message.success(s.meta.msg),t.getUsersList();case 7:case"end":return r.stop()}}),r)})))).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},UsersCate:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.next=2,t.$http.get("roles");case 2:if(s=r.sent,200===s.meta.status){r.next=5;break}return r.abrupt("return",t.$message.error(s.meta.msg));case 5:s.data.forEach((function(e){t.UsersForm.Users.push(e)})),t.UsersForm.username=e.username,t.UsersForm.role_name=e.role_name,t.editId=e.id,t.UsersDialogVisible=!0;case 10:case"end":return r.stop()}}),r)})))()},RolesAllocation:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$http.put("users/".concat(e.editId,"/role"),{rid:e.selectRolesId});case 2:if(r=t.sent,200===r.meta.status){t.next=5;break}return t.abrupt("return",e.$message.error(r.meta.msg));case 5:e.$message.success(r.meta.msg),e.getUsersList(),e.UsersDialogVisible=!1;case 8:case"end":return t.stop()}}),t)})))()}}},o=i,l=(r("cae4"),r("2877")),u=Object(l["a"])(o,s,a,!1,null,"582afc17",null);t["default"]=u.exports},8418:function(e,t,r){"use strict";var s=r("c04e"),a=r("9bf2"),n=r("5c6c");e.exports=function(e,t,r){var i=s(t);i in e?a.f(e,i,n(0,r)):e[i]=r}},"99af":function(e,t,r){"use strict";var s=r("23e7"),a=r("d039"),n=r("e8b5"),i=r("861d"),o=r("7b0b"),l=r("50c4"),u=r("8418"),c=r("65f0"),m=r("1dde"),d=r("b622"),p=r("2d00"),f=d("isConcatSpreadable"),b=9007199254740991,g="Maximum allowed index exceeded",h=p>=51||!a((function(){var e=[];return e[f]=!1,e.concat()[0]!==e})),v=m("concat"),w=function(e){if(!i(e))return!1;var t=e[f];return void 0!==t?!!t:n(e)},k=!h||!v;s({target:"Array",proto:!0,forced:k},{concat:function(e){var t,r,s,a,n,i=o(this),m=c(i,0),d=0;for(t=-1,s=arguments.length;t<s;t++)if(n=-1===t?i:arguments[t],w(n)){if(a=l(n.length),d+a>b)throw TypeError(g);for(r=0;r<a;r++,d++)r in n&&u(m,d,n[r])}else{if(d>=b)throw TypeError(g);u(m,d++,n)}return m.length=d,m}})},cae4:function(e,t,r){"use strict";var s=r("09b7"),a=r.n(s);a.a}}]);